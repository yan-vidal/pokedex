<div class="absolute inset-0 bg-red-600 rounded-l-2xl rounded-r-sm shadow-xl flex flex-col p-6 items-center justify-center pt-24 overflow-hidden"
     style="clip-path: path('M 0 85 Q 110 0, 320 0 L 320 520 L 0 520 Z');">
    
    <!-- 3D Border Overlay (Matching your manual path) -->
    <svg class="absolute inset-0 w-full h-full pointer-events-none z-50" viewBox="0 0 320 520" preserveAspectRatio="none">
      <path d="M 0 85 Q 110 0, 320 0 L 320 520 L 0 520 Z" 
            fill="none" 
            stroke="#991b1b" 
            stroke-width="8" />
    </svg>
    
    <!-- Triangular Decoration -->
    <div class="absolute top-6 right-3 w-0 h-0 border-l-[40px] border-l-transparent border-b-[40px] border-b-yellow-500 border-r-[40px] border-r-transparent rotate-45 opacity-80 translate-x-8 -translate-y-4"></div>

    <!-- LOGIN / REGISTRATION AREA -->
    <div class="w-full bg-slate-950 rounded-lg border-8 border-slate-800 p-4 shadow-[0_0_30px_rgba(0,0,0,0.6)] relative overflow-hidden">
        <!-- Scanline effect (subtle) -->
        <div class="absolute inset-0 bg-[linear-gradient(rgba(18,16,16,0)_50%,rgba(0,0,0,0.15)_50%)] z-10 pointer-events-none bg-[length:100%_4px]"></div>
        
        <!-- Logout Button (Inside Visor) -->
        @if (isLoggedIn()) {
            <button (click)="logout()" 
                    class="absolute top-2 right-2 z-30 bg-red-500/10 border border-red-500/50 text-red-400 text-[8px] px-2 py-0.5 rounded hover:bg-red-500 hover:text-white transition-all uppercase tracking-widest font-bold backdrop-blur-sm">
                LOGOUT
            </button>
        }

        <div class="relative z-20 font-mono text-emerald-500 text-xs flex flex-col gap-3">
            <div class="text-center border-b border-emerald-900/30 pb-1 mb-1 tracking-widest font-bold"
                 [ngClass]="{ 'text-amber-400': mode() === 'register', 'text-emerald-400': mode() === 'login' && !isLoggedIn(), 'text-sky-400': isLoggedIn() }">
                {{ statusMessage() }}
            </div>
            
            <!-- Inputs -->
            <div class="space-y-3">
                <div (click)="!isLoggedIn() && activeField.set('user')"
                     class="flex flex-col gap-1 group"
                     [ngClass]="{ 'cursor-pointer': !isLoggedIn() }">
                    <span class="text-[9px] text-emerald-900 group-hover:text-emerald-700 transition-colors">TRAINER ID</span>
                    <div class="bg-emerald-950/20 border border-emerald-900/50 p-1.5 h-7 flex items-center transition-all" 
                         [ngClass]="{ 'border-emerald-400 bg-emerald-900/30 shadow-[0_0_10px_rgba(52,211,153,0.1)]': activeField() === 'user' && !isLoggedIn() }">
                        <span class="tracking-widest">{{username()}}@if (activeField() === 'user' && !isLoggedIn()) { <span class="animate-pulse">_</span> }</span>
                    </div>
                </div>

                <div (click)="!isLoggedIn() && activeField.set('pass')"
                     class="flex flex-col gap-1 group"
                     [ngClass]="{ 'cursor-pointer': !isLoggedIn() }">
                    <span class="text-[9px] text-emerald-900 group-hover:text-emerald-700 transition-colors">ACCESS CODE</span>
                    <div class="bg-emerald-950/20 border border-emerald-900/50 p-1.5 h-7 flex items-center transition-all"
                         [ngClass]="{ 'border-emerald-400 bg-emerald-900/30 shadow-[0_0_10px_rgba(52,211,153,0.1)]': activeField() === 'pass' && !isLoggedIn() }">
                        <span class="tracking-widest">{{isLoggedIn() ? '********' : '*'.repeat(password().length)}}@if (activeField() === 'pass' && !isLoggedIn()) { <span class="animate-pulse">_</span> }</span>
                    </div>
                </div>
            </div>

            <!-- Error Message -->
            @if (errorMessage()) {
                <div class="text-center text-rose-500 text-[10px] animate-pulse font-bold tracking-tighter">
                    {{ errorMessage() }}
                </div>
            }

            @if (!isLoggedIn()) {
                <!-- Touch Keyboard -->
                <div class="grid grid-cols-6 gap-1 mt-1 pt-2 border-t border-emerald-950">
                    @for (k of keyboardKeys; track k) {
                        <button (click)="handleKeyPress(k)"
                                [disabled]="isLoading()"
                                class="bg-slate-900/50 border border-slate-800 text-emerald-600 text-[8px] h-6 rounded hover:bg-emerald-500 hover:text-slate-950 active:scale-95 transition-all disabled:opacity-30">
                            {{k}}
                        </button>
                    }
                    <button (click)="handleKeyPress('DEL')" class="bg-rose-950/20 border border-rose-900/50 text-rose-500 text-[8px] h-6 rounded col-span-2 hover:bg-rose-500 hover:text-white transition-all">DEL</button>
                    
                    @if (mode() === 'login') {
                        <button (click)="handleAction()" 
                                [disabled]="isLoading()"
                                class="bg-emerald-600 text-slate-950 font-bold text-[8px] h-6 rounded col-span-4 hover:bg-emerald-400 active:scale-[0.98] transition-all uppercase tracking-wider disabled:opacity-50">
                            {{ isLoading() ? '...' : 'Verify Identity' }}
                        </button>
                    } @else {
                        <button (click)="handleAction()" 
                                class="bg-amber-600 text-slate-950 font-bold text-[8px] h-6 rounded col-span-2 hover:bg-amber-400 transition-all uppercase tracking-wider">
                            CREATE ID
                        </button>
                        <button (click)="cancelRegister()" 
                                class="bg-slate-800 text-emerald-400 font-bold text-[8px] h-6 rounded col-span-2 hover:bg-slate-700 transition-all uppercase tracking-wider">
                            CANCEL
                        </button>
                    }
                </div>
            } @else {
                <!-- Logged In View: Avatar and Settings -->
                <div class="mt-1 pt-4 border-t border-emerald-900/20 flex flex-col items-center gap-4 animate-fade-in">
                    <!-- Holographic Avatar -->
                    <div class="w-20 h-20 bg-emerald-500/5 border-2 border-emerald-500/30 rounded-full flex items-center justify-center relative overflow-hidden shadow-[0_0_20px_rgba(16,185,129,0.1)]">
                        <div class="w-12 h-12 bg-emerald-500/20 rounded-full absolute -bottom-2 blur-sm"></div>
                        <div class="w-6 h-6 bg-emerald-500/20 rounded-full absolute top-4 blur-[1px]"></div>
                        <!-- Scanline on Avatar -->
                        <div class="absolute inset-0 bg-[linear-gradient(transparent_50%,rgba(16,185,129,0.1)_50%)] bg-[length:100%_2px]"></div>
                        <div class="absolute inset-0 bg-gradient-to-t from-emerald-500/20 to-transparent"></div>
                    </div>
                </div>
            }
        </div>
    </div>

    <!-- Hint -->
    <div class="mt-4 text-red-900/50 text-[10px] font-bold tracking-widest uppercase">
        Authorized Personnel Only
    </div>
    
    <div class="absolute bottom-6 w-full text-center">
        <div class="inline-block px-4 py-1 bg-red-800/50 rounded-full text-[10px] text-red-200 border border-red-500/30">
            PULL RIGHT TO OPEN
        </div>
    </div>
</div>
